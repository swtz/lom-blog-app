Curso de React JS 19 e Next.js 15 (atualizado para 2025)

Seção 3: Next.js 15, React 19 e Tailwind CSS v4: Introdução ao Desenvolvimento Moderno

Aula: 191. Mantenha o estado do form com useActionState e FormData

O 'arg1' da 'server-action' usada no primeiro parâmetro do hook 'useActionState' são
os dados que vem do formulário. É um objeto do tipo 'FormData' que carrega TODOS os
campos do 'form'. As chaves desse objeto são os nomes que os campos possuem (atributo
'name' do elemento JSX).

Exemplo de como fica a 'server-action':

type CreateActionState = {
  formState: PublicPost;
  errors: string[];
};

export async function createPostAction(
  prevState: CreateActionState,
  formData: FormData,
): Promise<CreateActionState> {
  const title = formData.get('title')?.toString() || '';

  return {
    formState: { ...prevState.formState, title },
    errors: [],
  };
}

Nota-se que, no retorno da 'server-action', é sobrescrita a propriedade 'title'
do Estado recebido, pelo valor também recebido do 'form'.

Nessa aula, o objeto foi MANTER O ESTADO do objeto no formulário com base nos valores
passados para os campos. Depois é que, de fato, a 'server-action' vai interagir com a
base de dados, a fim deles serem persistidos.
